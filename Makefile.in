SHELL = /bin/sh

prefix = @prefix@
exec_prefix = @exec_prefix@
BINDIR = @bindir@

CC = @CC@
CFLAGS = @CFLAGS@
AR = @AR@
ARFLAGS = @ARFLAGS@
INSTALL = @INSTALL@

LOADLIBS = routines/libddtsa.a -lm

# list of executables we want to produce
   ALL =   series two_series multi_series

all: $(ALL)

routines/libddtsa.a:
	(cd routines && $(MAKE))

$(ALL): routines/libddtsa.a *.c
	-$(CC) $(CFLAGS) $(COPTS) -o $@ $@.c $(LOADLIBS)

test: all
	./series -V0 test_data | cut -d\  -f2 | diff - test_col1
	./two_series -V0 -c1,3 test_data | diff - test_prod
	./multi_series -V0 -z 1.3 -Z 100 test_data | diff - test_col1

install: all
	-for bin in $(ALL); do $(INSTALL) $$bin $(BINDIR); done

clean:
	@rm -f *.o *~ #*#
	@rm -f $(ALL)
	-(cd routines && $(MAKE) clean)

missing:
	-@for bin in $(ALL); do \
	   test -z "`$$bin -h 2>&1 | grep Usage`" \
	      && echo   $$bin "(Dresden C)" >> missing.log; \
	   $$bin -h 2>&1 | cat >>  install.log; \
	  done; :

uninstall:
	-@for bin in $(ALL); do rm -f $(BINDIR)/$$bin; done

.PHONY: all test install clean missing uninstall
